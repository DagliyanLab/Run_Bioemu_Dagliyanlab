BioEmu â€“ Sidechain Rebuild Pipeline

Author: Tara / DagliyanLab, KI
Contact: tara.maharjan@ki.se

Pipeline assistant: ChatGPT

This repository contains a minimal, robust, and fully generic pipeline for running sidechain reconstruction on BioEmu sampling outputs using bioemu.sidechain_relax.

The system:

âœ” Works on any BioEmu sampling output directory

âœ” Does not depend on manifest files

âœ” Rebuilds directly into the original sampling directory

âœ” Uses a task list generated by scanning directories

âœ” Supports SLURM array jobs

âœ” Clean, modular, stable

âœ¨ Overview

BioEmu sampling produces directories in a structure such as:

outputs/multisite/PROTEIN/TAG/
    â”œâ”€â”€ samples.xtc
    â”œâ”€â”€ topology.pdb


This pipeline:

Scans a root directory to detect all sampling results

Generates a task list

Rebuilds sidechains (with hpacker) using SLURM array jobs

Writes reconstructed results directly back into the same folders

ğŸš€ Step 1 â€” Generate Task List (Run in Terminal)

This step is not handled by a script.
You directly generate the list in terminal so it is fully controlled by you.

```
cd /mimer/NOBACKUP/groups/naiss2025-5-451/Bioemu

ROOT=outputs/multisite
OUT=work/rebuild_tasks.txt
mkdir -p work

find "$ROOT" -type f -name "samples.xtc" -exec dirname {} \; \
  | while read -r d; do
        [[ -s "$d/topology.pdb" ]] && echo "$d"
    done \
  | sort -u > "$OUT"

echo "[OK] Tasks written to: $OUT"
wc -l "$OUT"
```

This will output something like:
```
/mimer/.../outputs/multisite/B1AUE5/B1AUE5_S16-S17_E
/mimer/.../outputs/multisite/B1AUE5/B1AUE5_S16-S17_Neutral
...
```

ğŸ— Step 2 â€” Submit SLURM Rebuild Job
Use:
```
cd /mimer/NOBACKUP/groups/naiss2025-5-451/Bioemu

head work/rebuild_tasks.txt

N=$(wc -l < work/rebuild_tasks.txt)
echo "Total tasks: $N"

sbatch --array=1-$N%8 run_rebuild_from_list.sh work/rebuild_tasks.txt
```

ğŸ’¡ Notes

No manifest file is needed

Any directory structure is allowed

Task list generation is 100% flexible

Rebuild results are placed in the same directory as sampling output

Supports WT, E, Neutral, or any custom variants automatically
